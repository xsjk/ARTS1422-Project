<script setup>
	import Heatmap from './components/heatmap.vue'
	import Districtmap from './components/district_division.vue'
	import Calendar from './components/d3/Calendar.vue'
	import Title from './components/d3/Title.vue'
	import { ref } from 'vue';
	import { computed} from 'vue';
	import * as d3 from 'd3';
	import HeatmapOverlay from 'heatmap.js/plugins/leaflet-heatmap';
	import L from 'leaflet';
	// import D3Wrapper from './d3/D3Wrapper.vue';
	import { discreteScheme } from './composables/color/scheme.js';
	// import { svg } from 'd3';
	
	const testData = {
	  max: 100,
	  data: [{'lng': 110.52109374999999, 'lat': 19.979843750000004, 'count': 1}, {'lng': 110.50171875, 'lat': 20.018593750000004, 'count': 1}, {'lng': 110.51140625000001, 'lat': 19.989531250000002, 'count': 2}, {'lng': 110.51140625000001, 'lat': 19.979843750000004, 'count': 10}, {'lng': 110.41453125000002, 'lat': 20.057343750000005, 'count': 1}, {'lng': 110.47265625000001, 'lat': 19.979843750000004, 'count': 2}, {'lng': 110.40484375000001, 'lat': 20.04765625, 'count': 3}, {'lng': 110.40484375000001, 'lat': 20.03796875, 'count': 3}, {'lng': 110.40484375000001, 'lat': 20.028281250000003, 'count': 3}, {'lng': 110.40484375000001, 'lat': 20.018593750000004, 'count': 1}, {'lng': 110.42421875000001, 'lat': 19.99921875, 'count': 1}, {'lng': 110.41453125000002, 'lat': 19.99921875, 'count': 1}, {'lng': 110.40484375000001, 'lat': 19.99921875, 'count': 1}, {'lng': 110.41453125000002, 'lat': 19.989531250000002, 'count': 2}, {'lng': 110.40484375000001, 'lat': 19.989531250000002, 'count': 1}, {'lng': 110.52109374999999, 'lat': 19.96046875, 'count': 1}, {'lng': 110.49203125000001, 'lat': 19.96046875, 'count': 5}, {'lng': 110.48234375, 'lat': 19.941093750000004, 'count': 7}, {'lng': 110.49203125000001, 'lat': 19.93140625, 'count': 1}, {'lng': 110.47265625000001, 'lat': 19.941093750000004, 'count': 2}, {'lng': 110.46296875, 'lat': 19.941093750000004, 'count': 24}, {'lng': 110.45328125000002, 'lat': 19.96046875, 'count': 1}, {'lng': 110.44359375, 'lat': 19.96046875, 'count': 13}, {'lng': 110.45328125000002, 'lat': 19.941093750000004, 'count': 1}, {'lng': 110.43390625000002, 'lat': 19.97015625, 'count': 18}, {'lng': 110.43390625000002, 'lat': 19.96046875, 'count': 3}, {'lng': 110.42421875000001, 'lat': 19.97015625, 'count': 3}, {'lng': 110.43390625000002, 'lat': 19.950781250000002, 'count': 3}, {'lng': 110.40484375000001, 'lat': 19.97015625, 'count': 2}, {'lng': 110.46296875, 'lat': 19.87328125, 'count': 1}, {'lng': 110.37578125, 'lat': 20.067031250000003, 'count': 1}, {'lng': 110.36609374999999, 'lat': 20.067031250000003, 'count': 3}, {'lng': 110.36609374999999, 'lat': 20.057343750000005, 'count': 5}, {'lng': 110.35640625, 'lat': 20.07671875, 'count': 1}, {'lng': 110.34671875, 'lat': 20.07671875, 'count': 5}, {'lng': 110.35640625, 'lat': 20.067031250000003, 'count': 9}, {'lng': 110.35640625, 'lat': 20.057343750000005, 'count': 14}, {'lng': 110.34671875, 'lat': 20.067031250000003, 'count': 23}, {'lng': 110.34671875, 'lat': 20.057343750000005, 'count': 31}, {'lng': 110.33703125000001, 'lat': 20.07671875, 'count': 5}, {'lng': 110.33703125000001, 'lat': 20.067031250000003, 'count': 15}, {'lng': 110.33703125000001, 'lat': 20.057343750000005, 'count': 24}, {'lng': 110.32734375, 'lat': 20.067031250000003, 'count': 14}, {'lng': 110.32734375, 'lat': 20.057343750000005, 'count': 11}, {'lng': 110.38546874999999, 'lat': 20.028281250000003, 'count': 3}, {'lng': 110.38546874999999, 'lat': 20.018593750000004, 'count': 6}, {'lng': 110.37578125, 'lat': 20.03796875, 'count': 6}, {'lng': 110.36609374999999, 'lat': 20.04765625, 'count': 3}, {'lng': 110.36609374999999, 'lat': 20.03796875, 'count': 23}, {'lng': 110.37578125, 'lat': 20.028281250000003, 'count': 22}, {'lng': 110.37578125, 'lat': 20.018593750000004, 'count': 26}, {'lng': 110.36609374999999, 'lat': 20.028281250000003, 'count': 42}, {'lng': 110.36609374999999, 'lat': 20.018593750000004, 'count': 17}, {'lng': 110.38546874999999, 'lat': 19.99921875, 'count': 5}, {'lng': 110.39515625, 'lat': 19.979843750000004, 'count': 3}, {'lng': 110.38546874999999, 'lat': 19.989531250000002, 'count': 19}, {'lng': 110.38546874999999, 'lat': 19.979843750000004, 'count': 4}, {'lng': 110.37578125, 'lat': 20.00890625, 'count': 37}, {'lng': 110.37578125, 'lat': 19.99921875, 'count': 15}, {'lng': 110.36609374999999, 'lat': 20.00890625, 'count': 31}, {'lng': 110.36609374999999, 'lat': 19.99921875, 'count': 35}, {'lng': 110.37578125, 'lat': 19.989531250000002, 'count': 32}, {'lng': 110.37578125, 'lat': 19.979843750000004, 'count': 9}, {'lng': 110.36609374999999, 'lat': 19.989531250000002, 'count': 44}, {'lng': 110.36609374999999, 'lat': 19.979843750000004, 'count': 19}, {'lng': 110.35640625, 'lat': 20.04765625, 'count': 28}, {'lng': 110.35640625, 'lat': 20.03796875, 'count': 31}, {'lng': 110.34671875, 'lat': 20.04765625, 'count': 20}, {'lng': 110.34671875, 'lat': 20.03796875, 'count': 23}, {'lng': 110.35640625, 'lat': 20.028281250000003, 'count': 47}, {'lng': 110.35640625, 'lat': 20.018593750000004, 'count': 25}, {'lng': 110.34671875, 'lat': 20.028281250000003, 'count': 62}, {'lng': 110.34671875, 'lat': 20.018593750000004, 'count': 14}, {'lng': 110.33703125000001, 'lat': 20.04765625, 'count': 22}, {'lng': 110.33703125000001, 'lat': 20.03796875, 'count': 32}, {'lng': 110.32734375, 'lat': 20.04765625, 'count': 12}, {'lng': 110.32734375, 'lat': 20.03796875, 'count': 33}, {'lng': 110.33703125000001, 'lat': 20.028281250000003, 'count': 70}, {'lng': 110.33703125000001, 'lat': 20.018593750000004, 'count': 40}, {'lng': 110.32734375, 'lat': 20.028281250000003, 'count': 46}, {'lng': 110.32734375, 'lat': 20.018593750000004, 'count': 28}, {'lng': 110.35640625, 'lat': 20.00890625, 'count': 33}, {'lng': 110.35640625, 'lat': 19.99921875, 'count': 26}, {'lng': 110.34671875, 'lat': 20.00890625, 'count': 6}, {'lng': 110.34671875, 'lat': 19.99921875, 'count': 33}, {'lng': 110.35640625, 'lat': 19.989531250000002, 'count': 28}, {'lng': 110.35640625, 'lat': 19.979843750000004, 'count': 3}, {'lng': 110.34671875, 'lat': 19.989531250000002, 'count': 31}, {'lng': 110.34671875, 'lat': 19.979843750000004, 'count': 7}, {'lng': 110.33703125000001, 'lat': 20.00890625, 'count': 47}, {'lng': 110.33703125000001, 'lat': 19.99921875, 'count': 57}, {'lng': 110.32734375, 'lat': 20.00890625, 'count': 35}, {'lng': 110.32734375, 'lat': 19.99921875, 'count': 22}, {'lng': 110.33703125000001, 'lat': 19.989531250000002, 'count': 34}, {'lng': 110.33703125000001, 'lat': 19.979843750000004, 'count': 19}, {'lng': 110.32734375, 'lat': 19.989531250000002, 'count': 22}, {'lng': 110.32734375, 'lat': 19.979843750000004, 'count': 58}, {'lng': 110.31765625000001, 'lat': 20.067031250000003, 'count': 12}, {'lng': 110.31765625000001, 'lat': 20.057343750000005, 'count': 7}, {'lng': 110.31765625000001, 'lat': 20.04765625, 'count': 4}, {'lng': 110.31765625000001, 'lat': 20.03796875, 'count': 2}, {'lng': 110.30796875, 'lat': 20.03796875, 'count': 1}, {'lng': 110.31765625000001, 'lat': 20.028281250000003, 'count': 56}, {'lng': 110.31765625000001, 'lat': 20.018593750000004, 'count': 38}, {'lng': 110.30796875, 'lat': 20.028281250000003, 'count': 22}, {'lng': 110.30796875, 'lat': 20.018593750000004, 'count': 40}, {'lng': 110.29828125000002, 'lat': 20.028281250000003, 'count': 18}, {'lng': 110.29828125000002, 'lat': 20.018593750000004, 'count': 51}, {'lng': 110.28859375, 'lat': 20.028281250000003, 'count': 11}, {'lng': 110.28859375, 'lat': 20.018593750000004, 'count': 22}, {'lng': 110.31765625000001, 'lat': 20.00890625, 'count': 9}, {'lng': 110.31765625000001, 'lat': 19.99921875, 'count': 19}, {'lng': 110.30796875, 'lat': 20.00890625, 'count': 31}, {'lng': 110.30796875, 'lat': 19.99921875, 'count': 29}, {'lng': 110.31765625000001, 'lat': 19.989531250000002, 'count': 24}, {'lng': 110.31765625000001, 'lat': 19.979843750000004, 'count': 4}, {'lng': 110.29828125000002, 'lat': 20.00890625, 'count': 19}, {'lng': 110.29828125000002, 'lat': 19.99921875, 'count': 32}, {'lng': 110.28859375, 'lat': 20.00890625, 'count': 42}, {'lng': 110.28859375, 'lat': 19.99921875, 'count': 30}, {'lng': 110.29828125000002, 'lat': 19.989531250000002, 'count': 3}, {'lng': 110.29828125000002, 'lat': 19.979843750000004, 'count': 5}, {'lng': 110.28859375, 'lat': 19.989531250000002, 'count': 8}, {'lng': 110.28859375, 'lat': 19.979843750000004, 'count': 14}, {'lng': 110.27890625000002, 'lat': 20.018593750000004, 'count': 16}, {'lng': 110.26921875000001, 'lat': 20.018593750000004, 'count': 2}, {'lng': 110.25953125000002, 'lat': 20.028281250000003, 'count': 1}, {'lng': 110.25953125000002, 'lat': 20.018593750000004, 'count': 7}, {'lng': 110.24984375000001, 'lat': 20.028281250000003, 'count': 2}, {'lng': 110.24984375000001, 'lat': 20.018593750000004, 'count': 2}, {'lng': 110.27890625000002, 'lat': 20.00890625, 'count': 20}, {'lng': 110.27890625000002, 'lat': 19.99921875, 'count': 8}, {'lng': 110.26921875000001, 'lat': 20.00890625, 'count': 5}, {'lng': 110.26921875000001, 'lat': 19.99921875, 'count': 5}, {'lng': 110.27890625000002, 'lat': 19.989531250000002, 'count': 3}, {'lng': 110.27890625000002, 'lat': 19.979843750000004, 'count': 7}, {'lng': 110.26921875000001, 'lat': 19.989531250000002, 'count': 2}, {'lng': 110.25953125000002, 'lat': 20.00890625, 'count': 3}, {'lng': 110.25953125000002, 'lat': 19.99921875, 'count': 3}, {'lng': 110.24984375000001, 'lat': 20.00890625, 'count': 3}, {'lng': 110.39515625, 'lat': 19.97015625, 'count': 2}, {'lng': 110.38546874999999, 'lat': 19.97015625, 'count': 3}, {'lng': 110.38546874999999, 'lat': 19.950781250000002, 'count': 1}, {'lng': 110.36609374999999, 'lat': 19.97015625, 'count': 2}, {'lng': 110.35640625, 'lat': 19.97015625, 'count': 3}, {'lng': 110.34671875, 'lat': 19.97015625, 'count': 2}, {'lng': 110.34671875, 'lat': 19.96046875, 'count': 1}, {'lng': 110.33703125000001, 'lat': 19.96046875, 'count': 1}, {'lng': 110.32734375, 'lat': 19.912031250000002, 'count': 2}, {'lng': 110.29828125000002, 'lat': 19.97015625, 'count': 3}, {'lng': 110.28859375, 'lat': 19.96046875, 'count': 2}, {'lng': 110.29828125000002, 'lat': 19.950781250000002, 'count': 2}, {'lng': 110.26921875000001, 'lat': 19.892656249999998, 'count': 1}, {'lng': 110.20140625, 'lat': 20.057343750000005, 'count': 1}, {'lng': 110.19171874999999, 'lat': 20.057343750000005, 'count': 3}, {'lng': 110.24015625, 'lat': 20.03796875, 'count': 2}, {'lng': 110.23046874999999, 'lat': 20.04765625, 'count': 1}, {'lng': 110.23046874999999, 'lat': 20.03796875, 'count': 1}, {'lng': 110.24015625, 'lat': 20.018593750000004, 'count': 1}, {'lng': 110.22078125, 'lat': 20.04765625, 'count': 2}, {'lng': 110.21109374999999, 'lat': 20.04765625, 'count': 1}, {'lng': 110.23046874999999, 'lat': 20.00890625, 'count': 1}, {'lng': 110.21109374999999, 'lat': 20.00890625, 'count': 2}, {'lng': 110.21109374999999, 'lat': 19.99921875, 'count': 2}, {'lng': 110.20140625, 'lat': 20.04765625, 'count': 3}, {'lng': 110.19171874999999, 'lat': 20.04765625, 'count': 4}, {'lng': 110.19171874999999, 'lat': 20.03796875, 'count': 1}, {'lng': 110.18203125000001, 'lat': 20.04765625, 'count': 1}, {'lng': 110.20140625, 'lat': 20.00890625, 'count': 2}, {'lng': 110.16265625000001, 'lat': 20.028281250000003, 'count': 4}]	
	};
	
	
	const testData2 = {
		max:100,
		data:[{'lng': 110.38890625, 'lat': 20.033906249999998, 'count': 0},
			 {'lng': 110.38890625, 'lat': 20.02421875, 'count': 0},
			 {'lng': 110.38164062499999, 'lat': 20.036328124999997, 'count': 0},
			 {'lng': 110.38164062499999, 'lat': 20.031484374999998, 'count': 0},
			 {'lng': 110.376796875, 'lat': 20.036328124999997, 'count': 1},
			 {'lng': 110.376796875, 'lat': 20.031484374999998, 'count': 0},
			 {'lng': 110.38164062499999, 'lat': 20.026640625, 'count': 4},
			 {'lng': 110.38164062499999, 'lat': 20.021796875, 'count': 8},
			 {'lng': 110.376796875, 'lat': 20.026640625, 'count': 10},
			 {'lng': 110.376796875, 'lat': 20.021796875, 'count': 6},
			 {'lng': 110.38890625, 'lat': 20.01453125, 'count': 0},
			 {'lng': 110.38890625, 'lat': 20.004843750000003, 'count': 0},
			 {'lng': 110.38164062499999, 'lat': 20.016953125, 'count': 0},
			 {'lng': 110.38164062499999, 'lat': 20.012109375, 'count': 2},
			 {'lng': 110.376796875, 'lat': 20.016953125, 'count': 2},
			 {'lng': 110.376796875, 'lat': 20.012109375, 'count': 10},
			 {'lng': 110.38164062499999, 'lat': 20.007265625000002, 'count': 0},
			 {'lng': 110.38164062499999, 'lat': 20.002421875000003, 'count': 0},
			 {'lng': 110.376796875, 'lat': 20.007265625000002, 'count': 3},
			 {'lng': 110.376796875, 'lat': 20.002421875000003, 'count': 4},
			 {'lng': 110.371953125, 'lat': 20.036328124999997, 'count': 3},
			 {'lng': 110.371953125, 'lat': 20.031484374999998, 'count': 9},
			 {'lng': 110.36710937500001, 'lat': 20.036328124999997, 'count': 2},
			 {'lng': 110.36710937500001, 'lat': 20.031484374999998, 'count': 10},
			 {'lng': 110.371953125, 'lat': 20.026640625, 'count': 6},
			 {'lng': 110.371953125, 'lat': 20.021796875, 'count': 9},
			 {'lng': 110.36710937500001, 'lat': 20.026640625, 'count': 10},
			 {'lng': 110.36710937500001, 'lat': 20.021796875, 'count': 15},
			 {'lng': 110.36226562499999, 'lat': 20.036328124999997, 'count': 7},
			 {'lng': 110.36226562499999, 'lat': 20.031484374999998, 'count': 11},
			 {'lng': 110.357421875, 'lat': 20.036328124999997, 'count': 10},
			 {'lng': 110.357421875, 'lat': 20.031484374999998, 'count': 8},
			 {'lng': 110.36226562499999, 'lat': 20.026640625, 'count': 8},
			 {'lng': 110.36226562499999, 'lat': 20.021796875, 'count': 5},
			 {'lng': 110.357421875, 'lat': 20.026640625, 'count': 17},
			 {'lng': 110.357421875, 'lat': 20.021796875, 'count': 10},
			 {'lng': 110.371953125, 'lat': 20.016953125, 'count': 8},
			 {'lng': 110.371953125, 'lat': 20.012109375, 'count': 13},
			 {'lng': 110.36710937500001, 'lat': 20.016953125, 'count': 0},
			 {'lng': 110.36710937500001, 'lat': 20.012109375, 'count': 8},
			 {'lng': 110.371953125, 'lat': 20.007265625000002, 'count': 9},
			 {'lng': 110.371953125, 'lat': 20.002421875000003, 'count': 13},
			 {'lng': 110.36710937500001, 'lat': 20.007265625000002, 'count': 9},
			 {'lng': 110.36710937500001, 'lat': 20.002421875000003, 'count': 13},
			 {'lng': 110.36226562499999, 'lat': 20.016953125, 'count': 2},
			 {'lng': 110.36226562499999, 'lat': 20.012109375, 'count': 12},
			 {'lng': 110.357421875, 'lat': 20.016953125, 'count': 5},
			 {'lng': 110.357421875, 'lat': 20.012109375, 'count': 4},
			 {'lng': 110.36226562499999, 'lat': 20.007265625000002, 'count': 7},
			 {'lng': 110.36226562499999, 'lat': 20.002421875000003, 'count': 5},
			 {'lng': 110.357421875, 'lat': 20.007265625000002, 'count': 7},
			 {'lng': 110.357421875, 'lat': 20.002421875000003, 'count': 10},
			 {'lng': 110.38890625, 'lat': 19.995156249999997, 'count': 0},
			 {'lng': 110.391328125, 'lat': 19.987890625, 'count': 0},
			 {'lng': 110.391328125, 'lat': 19.983046875, 'count': 0},
			 {'lng': 110.38648437500001, 'lat': 19.987890625, 'count': 3},
			 {'lng': 110.38648437500001, 'lat': 19.983046875, 'count': 5},
			 {'lng': 110.38164062499999, 'lat': 19.997578124999997, 'count': 1},
			 {'lng': 110.38164062499999, 'lat': 19.992734374999998, 'count': 11},
			 {'lng': 110.376796875, 'lat': 19.997578124999997, 'count': 3},
			 {'lng': 110.376796875, 'lat': 19.992734374999998, 'count': 4},
			 {'lng': 110.38164062499999, 'lat': 19.987890625, 'count': 15},
			 {'lng': 110.38164062499999, 'lat': 19.983046875, 'count': 2},
			 {'lng': 110.376796875, 'lat': 19.987890625, 'count': 14},
			 {'lng': 110.376796875, 'lat': 19.983046875, 'count': 10},
			 {'lng': 110.391328125, 'lat': 19.978203125, 'count': 3},
			 {'lng': 110.391328125, 'lat': 19.973359375, 'count': 1},
			 {'lng': 110.38648437500001, 'lat': 19.978203125, 'count': 0},
			 {'lng': 110.38648437500001, 'lat': 19.973359375, 'count': 1},
			 {'lng': 110.38890625, 'lat': 19.966093750000002, 'count': 0},
			 {'lng': 110.38164062499999, 'lat': 19.978203125, 'count': 0},
			 {'lng': 110.38164062499999, 'lat': 19.973359375, 'count': 2},
			 {'lng': 110.376796875, 'lat': 19.978203125, 'count': 1},
			 {'lng': 110.376796875, 'lat': 19.973359375, 'count': 0},
			 {'lng': 110.37921874999999, 'lat': 19.966093750000002, 'count': 0},
			 {'lng': 110.371953125, 'lat': 19.997578124999997, 'count': 3},
			 {'lng': 110.371953125, 'lat': 19.992734374999998, 'count': 4},
			 {'lng': 110.36710937500001, 'lat': 19.997578124999997, 'count': 9},
			 {'lng': 110.36710937500001, 'lat': 19.992734374999998, 'count': 0},
			 {'lng': 110.371953125, 'lat': 19.987890625, 'count': 0},
			 {'lng': 110.371953125, 'lat': 19.983046875, 'count': 0},
			 {'lng': 110.36710937500001, 'lat': 19.987890625, 'count': 14},
			 {'lng': 110.36710937500001, 'lat': 19.983046875, 'count': 14},
			 {'lng': 110.36226562499999, 'lat': 19.997578124999997, 'count': 5},
			 {'lng': 110.36226562499999, 'lat': 19.992734374999998, 'count': 12},
			 {'lng': 110.357421875, 'lat': 19.997578124999997, 'count': 7},
			 {'lng': 110.357421875, 'lat': 19.992734374999998, 'count': 3},
			 {'lng': 110.36226562499999, 'lat': 19.987890625, 'count': 19},
			 {'lng': 110.36226562499999, 'lat': 19.983046875, 'count': 4},
			 {'lng': 110.357421875, 'lat': 19.987890625, 'count': 3},
			 {'lng': 110.357421875, 'lat': 19.983046875, 'count': 0},
			 {'lng': 110.371953125, 'lat': 19.978203125, 'count': 0},
			 {'lng': 110.371953125, 'lat': 19.973359375, 'count': 3},
			 {'lng': 110.36710937500001, 'lat': 19.978203125, 'count': 3},
			 {'lng': 110.36710937500001, 'lat': 19.973359375, 'count': 2},
			 {'lng': 110.36953125000001, 'lat': 19.966093750000002, 'count': 0},
			 {'lng': 110.36226562499999, 'lat': 19.978203125, 'count': 3},
			 {'lng': 110.36226562499999, 'lat': 19.973359375, 'count': 0},
			 {'lng': 110.357421875, 'lat': 19.978203125, 'count': 1},
			 {'lng': 110.357421875, 'lat': 19.973359375, 'count': 0},
			 {'lng': 110.36226562499999, 'lat': 19.968515625000002, 'count': 0},
			 {'lng': 110.36226562499999, 'lat': 19.963671875000003, 'count': 0},
			 {'lng': 110.357421875, 'lat': 19.968515625000002, 'count': 0},
			 {'lng': 110.357421875, 'lat': 19.963671875000003, 'count': 1},
			 {'lng': 110.35257812500001, 'lat': 20.036328124999997, 'count': 8},
			 {'lng': 110.35257812500001, 'lat': 20.031484374999998, 'count': 9},
			 {'lng': 110.34773437500002, 'lat': 20.036328124999997, 'count': 2},
			 {'lng': 110.34773437500002, 'lat': 20.031484374999998, 'count': 20},
			 {'lng': 110.35257812500001, 'lat': 20.026640625, 'count': 11},
			 {'lng': 110.35257812500001, 'lat': 20.021796875, 'count': 15},
			 {'lng': 110.34773437500002, 'lat': 20.026640625, 'count': 10},
			 {'lng': 110.34773437500002, 'lat': 20.021796875, 'count': 7},
			 {'lng': 110.342890625, 'lat': 20.036328124999997, 'count': 6},
			 {'lng': 110.342890625, 'lat': 20.031484374999998, 'count': 7},
			 {'lng': 110.338046875, 'lat': 20.036328124999997, 'count': 15},
			 {'lng': 110.338046875, 'lat': 20.031484374999998, 'count': 19},
			 {'lng': 110.342890625, 'lat': 20.026640625, 'count': 27},
			 {'lng': 110.342890625, 'lat': 20.021796875, 'count': 6},
			 {'lng': 110.338046875, 'lat': 20.026640625, 'count': 24},
			 {'lng': 110.338046875, 'lat': 20.021796875, 'count': 15},
			 {'lng': 110.35257812500001, 'lat': 20.016953125, 'count': 2},
			 {'lng': 110.35257812500001, 'lat': 20.012109375, 'count': 4},
			 {'lng': 110.34773437500002, 'lat': 20.016953125, 'count': 1},
			 {'lng': 110.34773437500002, 'lat': 20.012109375, 'count': 2},
			 {'lng': 110.35257812500001, 'lat': 20.007265625000002, 'count': 7},
			 {'lng': 110.35257812500001, 'lat': 20.002421875000003, 'count': 7},
			 {'lng': 110.34773437500002, 'lat': 20.007265625000002, 'count': 2},
			 {'lng': 110.34773437500002, 'lat': 20.002421875000003, 'count': 3},
			 {'lng': 110.342890625, 'lat': 20.016953125, 'count': 1},
			 {'lng': 110.342890625, 'lat': 20.012109375, 'count': 6},
			 {'lng': 110.338046875, 'lat': 20.016953125, 'count': 3},
			 {'lng': 110.338046875, 'lat': 20.012109375, 'count': 6},
			 {'lng': 110.342890625, 'lat': 20.007265625000002, 'count': 2},
			 {'lng': 110.342890625, 'lat': 20.002421875000003, 'count': 15},
			 {'lng': 110.338046875, 'lat': 20.007265625000002, 'count': 20},
			 {'lng': 110.338046875, 'lat': 20.002421875000003, 'count': 14},
			 {'lng': 110.33320312500001, 'lat': 20.036328124999997, 'count': 6},
			 {'lng': 110.33320312500001, 'lat': 20.031484374999998, 'count': 8},
			 {'lng': 110.32835937500002, 'lat': 20.036328124999997, 'count': 10},
			 {'lng': 110.32835937500002, 'lat': 20.031484374999998, 'count': 6},
			 {'lng': 110.33320312500001, 'lat': 20.026640625, 'count': 15},
			 {'lng': 110.33320312500001, 'lat': 20.021796875, 'count': 20},
			 {'lng': 110.32835937500002, 'lat': 20.026640625, 'count': 11},
			 {'lng': 110.32835937500002, 'lat': 20.021796875, 'count': 9},
			 {'lng': 110.323515625, 'lat': 20.036328124999997, 'count': 0},
			 {'lng': 110.323515625, 'lat': 20.031484374999998, 'count': 13},
			 {'lng': 110.318671875, 'lat': 20.036328124999997, 'count': 0},
			 {'lng': 110.318671875, 'lat': 20.031484374999998, 'count': 12},
			 {'lng': 110.323515625, 'lat': 20.026640625, 'count': 17},
			 {'lng': 110.323515625, 'lat': 20.021796875, 'count': 12},
			 {'lng': 110.318671875, 'lat': 20.026640625, 'count': 31},
			 {'lng': 110.318671875, 'lat': 20.021796875, 'count': 12},
			 {'lng': 110.33320312500001, 'lat': 20.016953125, 'count': 9},
			 {'lng': 110.33320312500001, 'lat': 20.012109375, 'count': 6},
			 {'lng': 110.32835937500002, 'lat': 20.016953125, 'count': 11},
			 {'lng': 110.32835937500002, 'lat': 20.012109375, 'count': 1},
			 {'lng': 110.33320312500001, 'lat': 20.007265625000002, 'count': 8},
			 {'lng': 110.33320312500001, 'lat': 20.002421875000003, 'count': 6},
			 {'lng': 110.32835937500002, 'lat': 20.007265625000002, 'count': 9},
			 {'lng': 110.32835937500002, 'lat': 20.002421875000003, 'count': 0},
			 {'lng': 110.323515625, 'lat': 20.016953125, 'count': 5},
			 {'lng': 110.323515625, 'lat': 20.012109375, 'count': 8},
			 {'lng': 110.318671875, 'lat': 20.016953125, 'count': 8},
			 {'lng': 110.318671875, 'lat': 20.012109375, 'count': 0},
			 {'lng': 110.323515625, 'lat': 20.007265625000002, 'count': 11},
			 {'lng': 110.323515625, 'lat': 20.002421875000003, 'count': 9},
			 {'lng': 110.318671875, 'lat': 20.007265625000002, 'count': 2},
			 {'lng': 110.318671875, 'lat': 20.002421875000003, 'count': 4},
			 {'lng': 110.35257812500001, 'lat': 19.997578124999997, 'count': 11},
			 {'lng': 110.35257812500001, 'lat': 19.992734374999998, 'count': 7},
			 {'lng': 110.34773437500002, 'lat': 19.997578124999997, 'count': 3},
			 {'lng': 110.34773437500002, 'lat': 19.992734374999998, 'count': 2},
			 {'lng': 110.35257812500001, 'lat': 19.987890625, 'count': 17},
			 {'lng': 110.35257812500001, 'lat': 19.983046875, 'count': 4},
			 {'lng': 110.34773437500002, 'lat': 19.987890625, 'count': 7},
			 {'lng': 110.34773437500002, 'lat': 19.983046875, 'count': 1},
			 {'lng': 110.342890625, 'lat': 19.997578124999997, 'count': 17},
			 {'lng': 110.342890625, 'lat': 19.992734374999998, 'count': 7},
			 {'lng': 110.338046875, 'lat': 19.997578124999997, 'count': 17},
			 {'lng': 110.338046875, 'lat': 19.992734374999998, 'count': 7},
			 {'lng': 110.342890625, 'lat': 19.987890625, 'count': 16},
			 {'lng': 110.342890625, 'lat': 19.983046875, 'count': 3},
			 {'lng': 110.338046875, 'lat': 19.987890625, 'count': 4},
			 {'lng': 110.338046875, 'lat': 19.983046875, 'count': 16},
			 {'lng': 110.35257812500001, 'lat': 19.978203125, 'count': 0},
			 {'lng': 110.35257812500001, 'lat': 19.973359375, 'count': 0},
			 {'lng': 110.34773437500002, 'lat': 19.978203125, 'count': 2},
			 {'lng': 110.34773437500002, 'lat': 19.973359375, 'count': 0},
			 {'lng': 110.35257812500001, 'lat': 19.968515625000002, 'count': 1},
			 {'lng': 110.35257812500001, 'lat': 19.963671875000003, 'count': 1},
			 {'lng': 110.34773437500002, 'lat': 19.968515625000002, 'count': 0},
			 {'lng': 110.34773437500002, 'lat': 19.963671875000003, 'count': 0},
			 {'lng': 110.342890625, 'lat': 19.978203125, 'count': 1},
			 {'lng': 110.342890625, 'lat': 19.973359375, 'count': 1},
			 {'lng': 110.338046875, 'lat': 19.978203125, 'count': 1},
			 {'lng': 110.338046875, 'lat': 19.973359375, 'count': 0},
			 {'lng': 110.342890625, 'lat': 19.968515625000002, 'count': 1},
			 {'lng': 110.342890625, 'lat': 19.963671875000003, 'count': 0},
			 {'lng': 110.338046875, 'lat': 19.968515625000002, 'count': 0},
			 {'lng': 110.338046875, 'lat': 19.963671875000003, 'count': 0},
			 {'lng': 110.33320312500001, 'lat': 19.997578124999997, 'count': 8},
			 {'lng': 110.33320312500001, 'lat': 19.992734374999998, 'count': 9},
			 {'lng': 110.32835937500002, 'lat': 19.997578124999997, 'count': 11},
			 {'lng': 110.32835937500002, 'lat': 19.992734374999998, 'count': 7},
			 {'lng': 110.33320312500001, 'lat': 19.987890625, 'count': 4},
			 {'lng': 110.33320312500001, 'lat': 19.983046875, 'count': 43},
			 {'lng': 110.32835937500002, 'lat': 19.987890625, 'count': 8},
			 {'lng': 110.32835937500002, 'lat': 19.983046875, 'count': 13},
			 {'lng': 110.323515625, 'lat': 19.997578124999997, 'count': 5},
			 {'lng': 110.323515625, 'lat': 19.992734374999998, 'count': 4},
			 {'lng': 110.318671875, 'lat': 19.997578124999997, 'count': 2},
			 {'lng': 110.318671875, 'lat': 19.992734374999998, 'count': 13},
			 {'lng': 110.323515625, 'lat': 19.987890625, 'count': 1},
			 {'lng': 110.323515625, 'lat': 19.983046875, 'count': 4},
			 {'lng': 110.318671875, 'lat': 19.987890625, 'count': 3},
			 {'lng': 110.318671875, 'lat': 19.983046875, 'count': 2},
			 {'lng': 110.33320312500001, 'lat': 19.978203125, 'count': 4},
			 {'lng': 110.33320312500001, 'lat': 19.973359375, 'count': 0},
			 {'lng': 110.32835937500002, 'lat': 19.978203125, 'count': 4},
			 {'lng': 110.32835937500002, 'lat': 19.973359375, 'count': 0},
			 {'lng': 110.33078125000002, 'lat': 19.966093750000002, 'count': 0},
			 {'lng': 110.323515625, 'lat': 19.978203125, 'count': 3},
			 {'lng': 110.323515625, 'lat': 19.973359375, 'count': 0},
			 {'lng': 110.318671875, 'lat': 19.978203125, 'count': 0},
			 {'lng': 110.318671875, 'lat': 19.973359375, 'count': 0},
			 {'lng': 110.32109375, 'lat': 19.966093750000002, 'count': 0}]
			};
	
	
	const cityScheme = discreteScheme(42, 42).reverse();
	const newdata = ref([]);
	const weatherData = ref([]);
	
	// 用来获取数据的组合
	const getData = async () => {
	  const detailedData = await d3.csv('./static/house_pricing.csv');
	  const coordinalData = await d3.csv('./static/house_pricing_normalized.csv');
	  const weatherTest = await d3.csv('weatherData_temp.csv');
	  newdata.value = detailedData.map((d, i) => ({
	    ...d,
	    ...coordinalData[i],
	  }));
	  weatherData.value = weatherTest.map(d => d);
	};
	
	getData()
	
	const map = L.map('map', {
		center: [20.004658, 110.355043],
		zoom: 10,
		renderer: L.svg()
	})
	
	var setted = true;
	
	map.on('zoomend mouseup', (e) => {
		let scale = e.target.getZoom();
		console.log(scale);
		let center = e.target.getCenter();
		console.log(center);
		if(setted){
			heatmapLayer.setData(testData2);
			setted = false;
		}
		else{
			heatmapLayer.setData(testData);
			setted = true;
		}
	});
	
	// 加入基础地图
	let baseLayer = L.tileLayer(
	  'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
		attribution: 'Haut-Gis-Org © OpenStreetMap'
	})
	baseLayer.addTo(map);
	
	// 加入其他层级
	let heatmapLayer = Heatmap.methods.generate_layer(testData);
	let districtLayer = Districtmap.methods.generate_layer(data,map);
	
	L.control.scale({ maxWidth: 200, metric: true, imperial: false }).addTo(map)
	let mixed = {
		'heatmapLayer': heatmapLayer,
		'districtLayer': districtLayer
		//'OpenStreetMap': baseLayer,
	}
	L.control.layers(null, mixed).addTo(map);
</script>


<template>
	<div class="Time Selection" style="position: absolute;left: 400px;top: 500px;">
	<Calendar
		:data="
			weatherData.map((d) => ({
				date:new Date(d['date']),
				price:1,
			}))
		"
		:calendar_width="600"
		:cellSize="20"
		:clock_width="200"
		:clock_height="150"
	/>
	</div>
	<div class="Title"> 
		<Title
		:width="400"
		:height="200"
		:x="-8"
		:y="0"
		/>
	</div>
</template>

<style>
	.leaflet-container {
		height: 500px;
		width: 1000px;
		max-width: 100%;
		max-height: 100%;
		position: absolute;
		left: 400px;
		top: 0px;
	}
	
</style>

